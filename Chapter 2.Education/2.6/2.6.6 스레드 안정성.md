# 2.6.6 스레드 안정성

객체가 여러 스레드에서 동시에 사용될 수 있으며 그 결과를 항상 **예측 가능하도록** 유지할 수 있는 객체의 품질을 의미한다.  
다음은 스레드에 안전하지 않은 인스턴스를 생성하는 클래스이다.

```java
class Cash {
    private int dollars;
    private int cents;

    public void mul(int factor) {
        this.dollars *= factor;
        this.cents *= factor;
    }
}
```

두 개의 병렬 쓰레드 안에서 이 객체를 실행하면 어떤 일이 발생할 지 살펴보자.

```java
class Main {
    public static void main(String[] args) {
        Cash price = new Cash("$15.10");
        // 두 스레드 안에서 다음 두 줄을 실행
        price.mul(2);
        // "$30.20"와 "$60.40"이 예상됨
        System.out.println(price);
    }
}
```

불변 객체를 사용하게 되면 이 문제를 완벽하게 해결할 수 있다.  
어떤 쓰레드에서도 객체의 상태를 수정할 수 없기 때문에 아무리 많은 쓰레드가 객체에 접근해도 문제가 없다.

가변 클래스 역시 쓰레드를 안전하게 만들 수는 있다.  
하지만 문제점이 있다.

1. 가변 클래스에 쓰레드 안전성을 추가하는 일은 생각보다 어렵다.
2. 동기화 로직을 추가하는 일은 성능상의 비용을 초래한다.  
   각 쓰레드는 객체를 배타적으로 잠그기 때문에 다른 모든 쓰레드는 객체가 해제될 때까지 넋놓고 기다릴수 밖에 없다.

> 불변 객체를 사용하게 되면 쓰레드에서 안정적이다.